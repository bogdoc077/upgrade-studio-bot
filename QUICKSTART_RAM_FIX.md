# –®–≤–∏–¥–∫–∏–π —á–µ–∫–ª–∏—Å—Ç –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó RAM —Ç–∞ —Ç—Ä–∞—Ñ—ñ–∫—É

## üö® –ü–†–û–ë–õ–ï–ú–ò:
- RAM –ø–æ–≤–Ω—ñ—Å—Ç—é –∑–∞–π–Ω—è—Ç–∞ (90-100%)
- –í–∏—Ö—ñ–¥–Ω–∏–π —Ç—Ä–∞—Ñ—ñ–∫ ~90 –ì–ë/–¥–µ–Ω—å –±–µ–∑ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

## üîß –ì–û–õ–û–í–ù–ê –ü–†–ò–ß–ò–ù–ê:
**SQLAlchemy echo=True** –ª–æ–≥—É—î –í–°–Ü SQL –∑–∞–ø–∏—Ç–∏ ‚Üí –≥–µ–Ω–µ—Ä—É—î 5-7 –ì–ë –ª–æ–≥—ñ–≤/–¥–µ–Ω—å!

## –ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ –≤–∏–∫–æ–Ω–∞—Ç–∏:

### –í–∞—Ä—ñ–∞–Ω—Ç 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π (‚≠ê –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)
```bash
cd /home/admin/upgrade-studio-bot
git pull
./fix_all_issues.sh
```

### –í–∞—Ä—ñ–∞–Ω—Ç 2: –ü–æ–∫—Ä–æ–∫–æ–≤–æ
```bash
# 1. –û–Ω–æ–≤–∏—Ç–∏ –∫–æ–¥
cd /home/admin/upgrade-studio-bot
git pull

# 2. –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
source venv/bin/activate
python diagnose_traffic.py

# 3. –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è
python fix_traffic.py
python optimize_memory.py

# 4. –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ LOG_LEVEL=INFO
echo "LOG_LEVEL=INFO" >> .env

# 5. –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –æ–±–º–µ–∂–µ–Ω–Ω—è
./setup_resource_limits.sh
sudo cp /tmp/upgrade-*.service /etc/systemd/system/
sudo systemctl daemon-reload

# 6. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏
sudo systemctl restart upgrade-bot upgrade-api upgrade-webhook

# 7. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏
systemctl status upgrade-bot
iftop
```

## –©–æ –∑–º—ñ–Ω–∏–ª–æ—Å—å:

‚úÖ **echo=False** - –≤–∏–º–∫–Ω–µ–Ω–æ SQL –ª–æ–≥—É–≤–∞–Ω–Ω—è (–±—É–ª–æ 5-7 –ì–ë/–¥–µ–Ω—å!)  
‚úÖ **Connection pooling** - –µ–∫–æ–Ω–æ–º—ñ—è 60% –ø–∞–º'—è—Ç—ñ –Ω–∞ –ë–î  
‚úÖ **–ö—Ä–æ–Ω–∏**: 10 —Å–µ–∫ ‚Üí 2 —Ö–≤, 30 —Å–µ–∫ ‚Üí 5 —Ö–≤  
‚úÖ **–í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ –≤–∏—Ç–æ–∫–∏** –≤ payment_events  
‚úÖ **–û–±–º–µ–∂–µ–Ω–Ω—è –ë–î –∑–∞–ø–∏—Ç—ñ–≤** - –ø–æ 10-50 –∑–∞ —Ä–∞–∑  
‚úÖ **–ê–≤—Ç–æ–æ—á–∏—â–µ–Ω–Ω—è** —Å—Ç–∞—Ä–∏—Ö –ø–æ–¥—ñ–π (—â–æ–¥–Ω—è –æ 03:00)  
‚úÖ **Systemd –æ–±–º–µ–∂–µ–Ω–Ω—è**: RAM 256-512MB, CPU 30-50%  
‚úÖ **LOG_LEVEL=INFO** - –≤–∏–º–∫–Ω–µ–Ω–æ DEBUG –ª–æ–≥—É–≤–∞–Ω–Ω—è

## –û—á—ñ–∫—É–≤–∞–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏:

| –ú–µ—Ç—Ä–∏–∫–∞ | –ë—É–ª–æ | –°—Ç–∞–Ω–µ |
|---------|------|-------|
| **RAM** | 90-100% | 40-60% |
| **–¢—Ä–∞—Ñ—ñ–∫/–¥–µ–Ω—å** | ~90 –ì–ë | ~500 –ú–ë |
| **–ë–î –∑'—î–¥–Ω–∞–Ω–Ω—è** | –ù–µ–æ–±–º–µ–∂–µ–Ω–æ | 5-15 (–ø—É–ª) |
| **–ö—Ä–æ–Ω–∏/–≥–æ–¥–∏–Ω—É** | 240+ | 42 |
| **SQL –ª–æ–≥–∏** | 5-7 –ì–ë/–¥–µ–Ω—å | 0 |  

## –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥:

```bash
# –°—Ç–∞—Ç—É—Å
systemctl status upgrade-bot

# –ü–∞–º'—è—Ç—å
free -h
systemctl show upgrade-bot | grep Memory

# –õ–æ–≥–∏
journalctl -u upgrade-bot -f
```

## –ü—Ä–æ–±–ª–µ–º–∏?

1. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–≥–∏: `journalctl -u upgrade-bot -n 100`
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏: `sudo systemctl restart upgrade-bot`
3. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ë–î: `python optimize_memory.py`

---
**–î–∞—Ç–∞**: 15.01.2026  
**–§–∞–π–ª–∏**: 
- RAM_OPTIMIZATION.md - –ø–æ–≤–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
- apply_ram_optimization.sh - —Å–∫—Ä–∏–ø—Ç –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è
- optimize_memory.py - –æ—á–∏—â–µ–Ω–Ω—è —ñ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
